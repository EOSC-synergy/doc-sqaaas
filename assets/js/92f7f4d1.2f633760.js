"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[335],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=p(n),h=a,u=m["".concat(s,".").concat(h)]||m[h]||c[h]||r;return n?i.createElement(u,o(o({ref:t},d),{},{components:n})):i.createElement(u,o({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9924:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var i=n(7462),a=(n(7294),n(3905));const r={title:"Step 2 - the (Quality) Criteria"},o=void 0,l={unversionedId:"pipeline_as_a_service/step_2_criteria",id:"pipeline_as_a_service/step_2_criteria",title:"Step 2 - the (Quality) Criteria",description:"The step is the essential part of the pipeline composition since it is at this",source:"@site/docs/pipeline_as_a_service/step_2_criteria.md",sourceDirName:"pipeline_as_a_service",slug:"/pipeline_as_a_service/step_2_criteria",permalink:"/pipeline_as_a_service/step_2_criteria",draft:!1,tags:[],version:"current",frontMatter:{title:"Step 2 - the (Quality) Criteria"},sidebar:"tutorialSidebar",previous:{title:"Step 1 - the Repositories",permalink:"/pipeline_as_a_service/step_1_repositories"},next:{title:"Summary report",permalink:"/pipeline_as_a_service/summary"}},s={},p=[{value:"A brief overview of the existing quality criteria",id:"a-brief-overview-of-the-existing-quality-criteria",level:2},{value:"Adding the tools",id:"adding-the-tools",level:2},{value:"Running the tools with your own services",id:"running-the-tools-with-your-own-services",level:2},{value:"Pulling an image from a container registry",id:"pulling-an-image-from-a-container-registry",level:4},{value:"Building the image from a Dockerfile description",id:"building-the-image-from-a-dockerfile-description",level:4},{value:"Advanced options",id:"advanced-options",level:4}],d={toc:p};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"The step is the essential part of the pipeline composition since it is at this\nstage where the work to be carried out by the pipeline is defined. Hence, ",(0,a.kt)("strong",{parentName:"p"},"this\nis a mandatory step in order to successfully create a CI/CD pipeline with the\nSQAaaS platform"),"."),(0,a.kt)("p",null,"The pipeline work is represented by the quality criteria, and that means that\nat least one criterion has to be defined. The SQAaaS is aligned with quality\nstandards for ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/indigo-dc/sqa-baseline"},"software")," and\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/EOSC-synergy/service-qa-baseline"},"services"),", and you will\nnotice that by the codes or IDs that are used in the main ",(0,a.kt)("em",{parentName:"p"},"Criteria")," dropdown\nlist:"),(0,a.kt)("p",{align:"center"},(0,a.kt)("img",{src:"/img/criteria_dropdown.png"})),(0,a.kt)("p",null,"A description of each criterion will appear immediately after it is selected,\nso it can help you to make use of the most appropriate for the planned work."),(0,a.kt)("p",{align:"center"},(0,a.kt)("img",{src:"/img/criterion_description.png"})),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The SQAaaS does not validate that the work defined by the user corresponds or\nis related with the criterion it has been associated with. Thus, ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"the user is\nresponsible to select the appropriate criterion for the task at hand")),".")),(0,a.kt)("h2",{id:"a-brief-overview-of-the-existing-quality-criteria"},"A brief overview of the existing quality criteria"),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You will notice that the web interface takes some seconds to load the available\ncriteria. This is because the corresponding metadata is loaded dynamically from\na remote repository every time the Criteria view is accessed.")),(0,a.kt)("p",null,"In the current version, only software-related and data FAIRness criteria are\navailable. The following table summarizes the available criteria:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null}),(0,a.kt)("th",{parentName:"tr",align:null}))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#code-accessibility-qc.acc"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Acc"))),(0,a.kt)("td",{parentName:"tr",align:null},"Promotes the accessibility of the source code as a public resource")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#documentation-qc.doc"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Doc"))),(0,a.kt)("td",{parentName:"tr",align:null},"Formulates the good-to-have documents associated with code, both in terms of covering the target audience and those related to enabling external contributions")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"QC.FAIR")),(0,a.kt)("td",{parentName:"tr",align:null},"Catch-all criterion for data FAIR assessment. It encompasses all the potential FAIR indicators that can be validated by the associated tools")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#licensing-qc.lic"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Lic"))),(0,a.kt)("td",{parentName:"tr",align:null},"Resolves the legal aspects for source code reuse through the presence of license files")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#code-metadata-qc.met"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Met"))),(0,a.kt)("td",{parentName:"tr",align:null},"Promotes the identification and credit of software in research publications")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#security-qc.sec"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Sec"))),(0,a.kt)("td",{parentName:"tr",align:null},"Sets out the path for detecting unsecure patterns when writting code")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#code-style-qc.sty"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Sty"))),(0,a.kt)("td",{parentName:"tr",align:null},"Fosters readability of the code by following a style standard")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://indigo-dc.github.io/sqa-baseline/#unit-testing-qc.uni"},(0,a.kt)("inlineCode",{parentName:"a"},"QC.Uni"))),(0,a.kt)("td",{parentName:"tr",align:null},"Refers to the type of tests to be performed to verify the code")))),(0,a.kt)("h2",{id:"adding-the-tools"},"Adding the tools"),(0,a.kt)("p",null,"Based on the criterion selected, the SQAaaS supports a set of popular tools\nthat can help you cover its purpose. These tools are accessible through the\n",(0,a.kt)("em",{parentName:"p"},"Tool selection")," section, and in particular by clickin on the ",(0,a.kt)("inlineCode",{parentName:"p"},"Choose a Tool"),"\ndropdown. Each tool has its own set of arguments, including both positional\nand optional, that can be used to refine the tool's work. When ready, click\non the ",(0,a.kt)("inlineCode",{parentName:"p"},"Add tool")," button in order to add it as part of the criterion\nvalidation."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You can add more than one tool per criterion, but all of them shall be added\nwhen defining the given criterion. ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"You cannot modify or edit the work from\ncriteria that have been already defined")),".")),(0,a.kt)("p",null,"Once all the required tools are added, be sure to click on ",(0,a.kt)("inlineCode",{parentName:"p"},"Add Criterion")," so\nthat the defined work is added to the current CI/CD pipeline."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"After adding a given criterion, you will notice that it is still selectable\nin the criteria dropdown list. ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"In the event of redefining an existing\ncriterion, this last one will take precedence")),", thus overriding the\npreviously defined.")),(0,a.kt)("p",{align:"center"},(0,a.kt)("img",{src:"/img/criterion_add.gif"})),(0,a.kt)("h2",{id:"running-the-tools-with-your-own-services"},"Running the tools with your own services"),(0,a.kt)("p",null,"The supported tools, such as the one in the example above, are available in\npre-defined container images, so there is no need to create them and/or\ndefine the service or container that will make use of it when the pipeline gets\nexecuted."),(0,a.kt)("p",null,"This feature eases the composition of the CI/CD pipeline, but may not\nbe optimal for all use cases. For such use cases, the SQAaaS platform supports\nthe definition of custom services to execute the tools. This might be handy in\nthe event of requiring a version of the tool that is incompatible with the\ndefault one or when you also rely on other applications not available in the\ndefault container image, so a custom environment shall be created."),(0,a.kt)("admonition",{title:"Do I need a custom service?",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The main features of the pre-defined images are described in the form of labels\nthat are displayed once the tool has been selected. They provide valuable\ninformation to make a decision about whether a new service (with a new image)\nis needed. Information includes the version of the tool and the name of the\ncontainer image."),(0,a.kt)("p",{align:"center"},(0,a.kt)("img",{src:"/img/labels.png"}))),(0,a.kt)("p",null,"There are two fundamental ways to create a container or service definition,\neither using an existing container image from a container registry (",(0,a.kt)("em",{parentName:"p"},"pull"),"), or\nbuilding a custom image at runtime (",(0,a.kt)("em",{parentName:"p"},"build"),")."),(0,a.kt)("h4",{id:"pulling-an-image-from-a-container-registry"},"Pulling an image from a container registry"),(0,a.kt)("p",null,"The image has to be already available in a Docker registry for this feature to\nwork. By default, the pipeline will use ",(0,a.kt)("a",{parentName:"p",href:"https://hub.docker.com/"},"Docker Hub"),'.\nFollow the steps on "Docker image name syntax" to use a different registry.'),(0,a.kt)("admonition",{title:"Docker image name syntax",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The syntax for the ",(0,a.kt)("inlineCode",{parentName:"p"},"Image Name")," field follows the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/reference/commandline/tag/#extended-description"},"Docker syntax for image names"),". Note that:"),(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"In order to use a registry other than Docker Hub (",(0,a.kt)("inlineCode",{parentName:"li"},"registry-1.docker.io"),")\nyou need to prefix the image name with such registry's hostname, such as\n",(0,a.kt)("inlineCode",{parentName:"li"},"myregistryhost:5000/fedora/httpd:version1.0")),(0,a.kt)("li",{parentName:"ul"},"You can use the values of the available environment variables to compose\nthe image name. This includes the ones defined in ",(0,a.kt)("a",{parentName:"li",href:"step_1_repositories##environment"},"Step 1")," and also the\nones exposed by the Jenkins plugins, such as the ",(0,a.kt)("inlineCode",{parentName:"li"},"GIT_*")," variables from the\n",(0,a.kt)("a",{parentName:"li",href:"https://plugins.jenkins.io/git/#environment-variables"},"Git plugin"),"."))),(0,a.kt)("p",null,"The following figure showcases the process of defining a tooling service:"),(0,a.kt)("p",{align:"center"},(0,a.kt)("img",{src:"/img/tooling_pull.gif"})),(0,a.kt)("p",null,"When clicking on ",(0,a.kt)("inlineCode",{parentName:"p"},"Add Service")," the ",(0,a.kt)("inlineCode",{parentName:"p"},"python3-service")," in the example will be\navailable when defining the pipeline work in the next ",(0,a.kt)("em",{parentName:"p"},"Criteria")," step."),(0,a.kt)("h4",{id:"building-the-image-from-a-dockerfile-description"},"Building the image from a Dockerfile description"),(0,a.kt)("p",null,"In some cases, a custom Docker image needs to be built out of a Dockerfile\npresent in the code repository. The required parameters differ slightly from\nthe ones used when fetching an existing image from an external registry:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Dockerfile Location")," (required) shall contain the relative path (taken from\nthe root path of the repository) to the Dockerfile. ",(0,a.kt)("em",{parentName:"li"},"No default value is set")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Build arguments")," (optional) contains a list of key-value items that will be\nprovided to Docker at build time. Follows the\n",(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/engine/reference/commandline/build/#set-build-time-variables---build-arg"},"Docker convention for build arguments"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Would you like to push the Docker image to a registry?")," (optional): if\nrequired, the built image can be pushed to a Docker registry. To successfully\nperform this operation credentials are needed. As it happened when ",(0,a.kt)("a",{parentName:"li",href:"/pipeline_as_a_service/step_1_repositories#Credentials"},"accessing\nprivate repositories in Step 1"),", we only\nsupport for the time being credentials defined in the Jenkins service.\nHowever, there is a workaround to save time if you just want to test the push\nprocess out. This implies using a catch-all credential that will push the\nresultant image to the EOSC-Synergy organization at Docker Hub.")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"If the ",(0,a.kt)("inlineCode",{parentName:"p"},"Dockerfile")," is present at the root of the repository, you still need\nto set the value in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Dockerfile Location"),". This is due to the fact that\nboth the ",(0,a.kt)("em",{parentName:"p"},"context")," (directory name) and ",(0,a.kt)("em",{parentName:"p"},"dockerfile")," (file name) values are\ntaken from such value.")),(0,a.kt)("p",{align:"center"},(0,a.kt)("img",{src:"/img/tooling_build.gif"})),(0,a.kt)("h4",{id:"advanced-options"},"Advanced options"),(0,a.kt)("p",null,"Through the Advanced options section, the Tooling view offers a more detailed\nconfiguration of some of the Docker parameters:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Hostname")," is the equivalent of\n",(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir"},"Docker Compose's ",(0,a.kt)("inlineCode",{parentName:"a"},"hostname")," property"),",\nwhich sets the container hostname so it can be reached from other containers."),(0,a.kt)("li",{parentName:"ul"},"Volumes:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Volume Type")," refers to the type of the volume. Currently, ",(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/storage/bind-mounts/"},"only ",(0,a.kt)("inlineCode",{parentName:"a"},"bind")," is\nsupported"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Volume Source")," specifies the source path of the volume (for named volumes,\nthe name of the volume shall be used)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Volume Target")," points to the destination path where the directory will be\nmounted in the container.")))),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You can add as many volumes as you need. Remember to click on ",(0,a.kt)("inlineCode",{parentName:"p"},"Add Volume"),"\nbutton for each defined volume.")))}c.isMDXComponent=!0}}]);